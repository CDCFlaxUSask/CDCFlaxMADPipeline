if(unadjusted_subplot_anova_stats[i,9] != 99 && unadjusted_subplot_anova_stats[i,9] <= 0.05)
{
unadjusted_subplot_anova_stats[i,10]<-"*"
}
if(unadjusted_subplot_anova_stats[i,9] != 00 && unadjusted_subplot_anova_stats[i,9] <= 0.01)
{
unadjusted_subplot_anova_stats[i,10]<-"**"
}
if(unadjusted_plot_anova_stats[i,9] != 99 && unadjusted_plot_anova_stats[i,9] <= 0.05)
{
unadjusted_plot_anova_stats[i,10]<-"*"
}
if(unadjusted_plot_anova_stats[i,9] != 99 && unadjusted_plot_anova_stats[i,9] <= 0.01)
{
unadjusted_plot_anova_stats[i,10]<-"**"
}
unadjusted_subplot_anova_stats[i,11]<-unadjusted_subplot_anova_stats[i,6]/unadjusted_subplot_anova_stats[i,5]
unadjusted_plot_anova_stats[i,11]<-unadjusted_plot_anova_stats[i,6]/unadjusted_plot_anova_stats[i,5]
unadjusted_subplot_anova_stats[i,12] <- unadjusted_plot_anova_stats[i,11]/unadjusted_subplot_anova_stats[i,11]
unadjusted_plot_anova_stats[i,12] <- unadjusted_plot_anova_stats[i,11]/unadjusted_subplot_anova_stats[i,11]
#unadjusted_subplot_anova_stats[i,12] <- rxc_significance
#unadjusted_plot_anova_stats[i,13] <- rxc_significance
}
anova_stats <-rbind(unadjusted_subplot_anova_stats,unadjusted_plot_anova_stats)
anova_stats <- anova_stats[with(anova_stats , order(Year, Location, Type, Df)),]
#anova_stats <- anova_stats[with(anova_stats , order(Type, Location, Year)),]
GetMethod <- function(RS,CS,RXCS,RF,CF,RXFC)
{
# determine method
method='Method 1'
if ((grepl( '*', RS, fixed = TRUE) && grepl( '*', CS, fixed = TRUE)) && grepl( 'ns', RXCS, fixed = TRUE))
{
method <-'Method 1'
adj_method <-1
}
else if ((grepl( 'ns', RS, fixed = TRUE)  && grepl( 'NS', CS, fixed = TRUE) ) && grepl( '*', RXCS, fixed = TRUE) )
{
method = 'Method 3'
adj_method <-3
}
else if ((grepl( 'ns', RS, fixed = TRUE)  && grepl( 'ns', CS, fixed = TRUE) ) && grepl( 'ns', RXCS, fixed = TRUE) )
{
method <-'Unnecessary'
adj_method <-  0
# According to ANOVA results, even row and column effects are not significant, still use Method 1
#			method <-'Method 1'
#			adj_method <-1
}
else if ((grepl( '*', RS, fixed = TRUE)  && grepl( '*', CS, fixed = TRUE) ) && grepl( '*', RXCS, fixed = TRUE) )
{
method <-'Method 1'
adj_method <- 1
}
else if ((grepl( '*', RS, fixed = TRUE)  && grepl( 'ns', CS, fixed = TRUE) ) && grepl( '*', RXCS, fixed = TRUE) )
{
method <- 'Method 1 or Method 3 but'
if (RXFC > CF && rxc_f > RF)
{
method <- method + ' Method 3 is better'
adj_method = 3
}
else
{
method <- method + ' Method 1 is better'
adj_method = 1
}
}
return(method)
}
traits <- unique(cp1$Trait)
MethodsForTraits <- setNames(numeric(length(traits)), traits)
for (i in 1:nrow(anova_stats)) #i=6
{
typeIs <- anova_stats[i,4]
if (typeIs == "ERROR_WG") {
df2Is<-anova_stats[i,5]
rxc_fIs<-anova_stats[i,12]
}
if (typeIs == "ROW") {
rowSig<-anova_stats[i,10]
rowF<-anova_stats[i,8]
}
if (typeIs == "COL") {
colSig<-anova_stats[i,10]
colF<-anova_stats[i,8]
}
if (typeIs == "ERROR_RXC") {
df1Is<-anova_stats[i,5]
#rxc_fIs<-anova_stats[i,12]
#anova_stats[i,3]
fprob<- 1-pf(rxc_fIs, df1Is, df2Is,rowF,colF,rxc_fIs) #qf(rxc_fIs, df1Is, df2Is)
if (fprob <= 0.01) {
rxc_significance = "**"
} else if (fprob <= 0.05) {
rxc_significance = "*"
} else {
rxc_significance = "ns"
}
anova_stats[i,14]<-fprob
methodVal<-GetMethod(rowSig,colSig,rxc_significance)
anova_stats[i,15] <-methodVal
MethodsForTraits[anova_stats[i,3]]<-methodVal
}
}
write.csv(anova_stats , file = paste(DataFileDircsv,"MAD_ANOVA_result_summary",".csv"),row.names=FALSE)
###################adjusting_testlines_data_M1_M3
#sub adjusting_testlines_data_M1_M3
p_reg_coes <- rcoeffs
data_file <- datap1
#adjusting_testlines_data_M1_M3
#data_file
#p_row_means2
#p_col_means2
#p_total_means
#p_row_col_values
#p_reg_coes
data_file$adjmth1 <- 0
data_file$adjmth3 <- 0
#####MTH 1 and MTH3 ###################################################################################3
for(i in 1:nrow(data_file))
{
#i=9
idis<-data_file[i,"IDX"]
ids<-p_reg_coes["ListID"]
idxpregcoes<-which(ids == idis)
idisr<-data_file[i,"IDROW"]
idr<-p_row_means2["IDROW"]
idxrow<-which(idr == idisr)
idisc<-data_file[i,"IDCOL"]
idc<-p_col_means2["IDCOL"]
idxcol<-which(idc == idisc)
idisrc<-data_file[i,"IDROWCOL"]
idrc<-p_row_col_values["IDROWCOL"]
idxrowcol<-which(idrc == idisrc)
if (data_file[i,12] == '.' || data_file[i,12] == 0)
{
data_file[i,18] <- data_file[i,12]
data_file[i,19] <- data_file[i,12]
}
else
{
data_file[i,18] = data_file[i,12] - p_row_means2[idxrow,"Value"] - p_col_means2[idxcol,"Value"] + 2*p_total_means[idxpregcoes,"Value"]
xij <- p_row_col_values[idxrowcol,"Value"]
if (!xij || is.na(xij))
{
xij <- (p_row_means2[idxrow,"Value"] + p_col_means2[idxcol,"Value"])/2;
}
if (p_reg_coes[idxpregcoes,"op"] && p_total_means[idxpregcoes,"Value"]) {
data_file[i,19] <- data_file[i,12] - p_reg_coes[idxpregcoes,"op"] * (xij - p_total_means[idxpregcoes,"Value"]);
}
if (data_file[i,18] < 0 || is.na(data_file[i,18])) {data_file[i,18] <- 0}
if (data_file[i,19] < 0 || is.na(data_file[i,19])) {data_file[i,19] <- 0}
}
}
write.csv(data_file , file = paste(DataFileDircsv,"data_file_mth1_mth3",".csv"),row.names=FALSE)
#####MTH 1 and MTH3 ###################################################################################3
#data_file$adjmth13x <- (data_file$adjmth3*100+0.5)/100
#write.csv(data_file, file = paste(DataFileDircsv,"MAD_adjusted_all_data_Method1and3.csv",sep=""),row.names=FALSE)
data_file$adjmth13 <- 0
#####MTH1+3 ###################################################################################
for(i in 1:nrow(data_file))
{
#i=9
idis<-data_file[i,"IDX"]
ids<-p_reg_coes["ListID"]
idxpregcoes<-which(ids == idis)
idisr<-data_file[i,"IDROW"]
idr<-p_row_means2["IDROW"]
idxrow<-which(idr == idisr)
idisc<-data_file[i,"IDCOL"]
idc<-p_col_means2["IDCOL"]
idxcol<-which(idc == idisc)
idisrc<-data_file[i,"IDROWCOL"]
idrc<-p_row_col_values["IDROWCOL"]
idxrowcol<-which(idrc == idisrc)
if (data_file[i,18] == '.' || data_file[i,18] == 0)
{
data_file[i,20] <- data_file[i,18]
}
else
{
if (p_reg_coes[idxpregcoes,"op"] && p_total_means[idxpregcoes,"Value"]) {
data_file[i,20] <- data_file[i,18] - p_reg_coes[idxpregcoes,"op"] * (xij - p_total_means[idxpregcoes,"Value"]);
}
if (data_file[i,20] < 0 || is.na(data_file[i,20])) {data_file[i,20] <- 0}
}
}
write.csv(data_file , file = paste(DataFileDircsv,"data_file_mth1+3",".csv",sep=""),row.names=FALSE)
data_fileCRTL <- data_file
data_fileCRTL$CTRLGENOTYPE <- 0 #create an environment attribute in the dataframe
#if (data_fileCRTL$Cp == 1)
#{
#  data_fileCRTL$CTRLGENOTYPE <- 1;
#}
#if (data_fileCRTL$Csp > 0)
#{
#  data_fileCRTL$CTRLGENOTYPE <- 1;
#}
data_fileCRTL <- transform(data_fileCRTL, CTRLGENOTYPE= ifelse(Cp==1 | Csp > 0, 1, 0))
write.csv(data_fileCRTL , file = paste(DataFileDircsv,"data_file_mth1+3+crtl",".csv"),row.names=FALSE)
data_fileCRTLFilter<-subset(data_fileCRTL, CTRLGENOTYPE==1)
newdata <- data_fileCRTLFilter[c(16,12,18:20)]
dput(head(newdata))
aggregate(Value~IDX,data=newdata,FUN=mean)
meansq <- function(x) sum((x-mean(x))^2)/(length(x)-1)
msdata <- newdata %>% group_by(IDX) %>% summarize(across(c(Value, adjmth1, adjmth3, adjmth13), meansq))
write.csv(msdata , file = paste(DataFileDircsv,"ms",".csv",sep=""),row.names=FALSE)
msdata$rm1 <- 0
msdata$rm3 <- 0
msdata$rm13 <- 0
msdata$PrefMeth <- "m1"
#####MTH1+3 ######################
for(i in 1:nrow(msdata)) #i<-1
{       # for-loop over columns
#print (msdata[i,1])
msdata[i,6]=(msdata[i,2]/msdata[i,3] * 100 * 100 + .5)/100
msdata[i,7]=(msdata[i,2]/msdata[i,4] * 100 * 100 + .5)/100
msdata[i,8]=(msdata[i,2]/msdata[i,5] * 100 * 100 + .5)/100
maxmeth=c(msdata[i,6],msdata[i,7],msdata[i,8])
max(unlist(maxmeth))
if (msdata[i,6] >= msdata[i,7] & msdata[i,6] >= msdata[i,8]) { maxmeth ="m1"}
else if (msdata[i,7] >= msdata[i,6] & msdata[i,7] >= msdata[i,8]) { maxmeth ="m3"}
else if (msdata[i,8] >= msdata[i,6] & msdata[i,8] >= msdata[i,6]) { maxmeth ="m13"}
msdata[i,9]<-maxmeth
#print (i)
}
write.csv(msdata , file = paste(DataFileDircsv,"msPref",".csv",sep=""),row.names=FALSE)
#############################################################
########################################################################################################CV
ControlPlotData <- filter(data_file,(data_file$Cp > 0))
ControlSubPlotData <- filter(data_file,(data_file$Csp > 0))
# meansq <- function(x) sum((x-mean(x))^2)/(length(x)-1)
# msdata <- newdata %>% group_by(IDX) %>% summarize(across(c(Value, adjmth1, adjmth3, adjmth13), meansq))
########################################################################################################CV
adjdata <- data_file
ctldata <- adjdata
ctldata <- filter(ctldata,(ctldata$Cp == 1) | (ctldata$Csp > 0))
#####################read_adjusted_data
data_file_Adjustedm1m3 <- data_file
data_file_Adjustedm1m3$control_genotypes <- 0
#  data_file_Adjustedm1m3$control_genotypes <- 0
#datap1cg <- filter(data, (data$Csp > 0) | (data$Cp == 1))
data_file_Adjustedm1m3FilteredCp <- filter(data_file_Adjustedm1m3,(data_file_Adjustedm1m3$Cp == 1))
data_file_Adjustedm1m3FilteredCpTestPlots <- filter(data_file_Adjustedm1m3,(data_file_Adjustedm1m3$Cp != 1))
#data_file_Adjustedm1m3FilteredCp <- filter(data_file_Adjustedm1m3,(data_file_Adjustedm1m3$Csp > 0) | (data_file_Adjustedm1m3$Cp == 1))
#data_file_Adjustedm1m3FilteredCp <- filter(data_file_Adjustedm1m3,(data_file_Adjustedm1m3$Value != 0) )
ctlgeno<-filter(data_file_Adjustedm1m3FilteredCp,(data_file_Adjustedm1m3FilteredCp$Cp == 1 | data_file_Adjustedm1m3FilteredCp$Csp > 0))
# write.csv(data_file_Adjustedm1m3FilteredCp, file = paste(txtdir,"data_file_Adjustedm1m3FilteredCp.csv",sep=""),row.names=FALSE)
read_adjusted_data <- aggregate( adjmth1 ~ IDROW , data_file_Adjustedm1m3FilteredCp, mean )#row_means
col_meansAM1 <- aggregate( adjmth1 ~ IDCOL , data_file_Adjustedm1m3FilteredCp, mean )#col_means
total_meansAM1 <- aggregate( adjmth1 ~ IDX , data_file_Adjustedm1m3FilteredCp, mean )#total_means
row_col_meansAM1 <- aggregate( adjmth1 ~ IDROWCOL , data_file_Adjustedm1m3FilteredCp, mean )#total_means
row_col_testplots_meansAM1 <- aggregate( adjmth1 ~ IDROWCOL , data_file_Adjustedm1m3FilteredCpTestPlots, mean )#total_means
row_meansAM3 <- aggregate( adjmth3 ~ IDROW , data_file_Adjustedm1m3FilteredCp, mean )#row_means
col_meansAM3 <- aggregate( adjmth3 ~ IDCOL , data_file_Adjustedm1m3FilteredCp, mean )#col_means
total_meansAM3 <- aggregate( adjmth3 ~ IDX , data_file_Adjustedm1m3FilteredCp, mean )#total_means
row_col_meansAM3 <- aggregate( adjmth3 ~ IDROWCOL , data_file_Adjustedm1m3FilteredCp, mean )#total_means
row_col_testplots_meansAM3 <- aggregate( adjmth3 ~ IDROWCOL , data_file_Adjustedm1m3FilteredCpTestPlots, mean )#total_means
#Define the file name that will be deleted
fn <- paste(DataFileDircsv,"read_adjusted_data",".xlsx",sep="")
#Check its existence
if (file.exists(fn)) {
#Delete file if it exists
file.remove(fn)
}
library(xlsx)
write.xlsx(read_adjusted_data, file=fn, sheetName="read_adjusted_data", row.names=FALSE)
write.xlsx(col_meansAM1, file=fn, sheetName="col_meansAM1", append=TRUE, row.names=FALSE)
write.xlsx(row_col_meansAM1, file=fn, sheetName="row_col_meansAM1", append=TRUE, row.names=FALSE)
write.xlsx(total_meansAM1, file=fn, sheetName="total_meansAM1", append=TRUE, row.names=FALSE)
write.xlsx(row_col_testplots_meansAM1, file=fn, sheetName="row_col_testplots_meansAM1", append=TRUE, row.names=FALSE)
write.xlsx(row_meansAM3, file=fn, sheetName="row_meansAM3", append=TRUE, row.names=FALSE)
write.xlsx(col_meansAM3, file=fn, sheetName="col_meansAM3", append=TRUE, row.names=FALSE)
write.xlsx(total_meansAM3, file=fn, sheetName="total_meansAM3", append=TRUE, row.names=FALSE)
write.xlsx(row_col_meansAM3, file=fn, sheetName="row_col_meansAM3", append=TRUE, row.names=FALSE)
write.xlsx(row_col_testplots_meansAM3, file=fn, sheetName="row_col_testplots_meansAM3", append=TRUE, row.names=FALSE)
subplot_anova_file_data<-unadjusted_subplot_anova_stats
#ROBM
#####################################################################################################################################################
subplot_ERROR <- read.csv(text="id,df,f,p", colClasses = c("integer", "integer", "numeric","numeric"))
subplot_BLOCK <- read.csv(text="id,df,f,p", colClasses = c("integer", "integer", "numeric","numeric"))
ctldata$IDXGT <- paste(ctldata$IDX,"_",ctldata$Genotype,sep="")
control_values <- select(ctldata, c('IDXGT', 'IDX', 'Genotype', 'Value'))
control_values_genotype <- unique(control_values$Genotype)
control_values_m1 <- select(ctldata, c('IDXGT', 'IDX', 'Genotype', 'adjmth1'))
control_values_genotype_m1 <- unique(control_values_m1$Genotype)
control_values_m3 <- select(ctldata, c('IDXGT', 'IDX', 'Genotype', 'adjmth3'))
control_values_genotype_m3 <- unique(control_values_m3$Genotype)
control_values_m13 <- select(ctldata, c('IDXGT', 'IDX', 'Genotype', 'adjmth1'))
#colnames(control_values_m13)[4] <- "adjmth13"
control_values_m13$adjmth13  <- (control_values_m13$adjmth1*100+0.5)/100
control_values_genotype_m13 <- unique(control_values_m3$Genotype)
write.csv(ctldata, file = paste(DataFileDir,"ctldata",".csv",sep=""),row.names=FALSE)
write.csv(ctldata, file = paste(DataFileDircsv,"ctldata",".csv",sep=""),row.names=FALSE)
vvv <- unique(ctldata$IDXGT)
for(i in 1:nrow(subplot_anova_file_data)) #i=1
{
if (subplot_anova_file_data[i,4] == "ERROR_WG")
{
subplot_ERROR[i,1] <- paste(subplot_anova_file_data[i,1],subplot_anova_file_data[i,2],subplot_anova_file_data[i,3],sep="-")
subplot_ERROR[i,2] <- subplot_anova_file_data[i,5]
subplot_ERROR[i,3] <- subplot_anova_file_data[i,8]
subplot_ERROR[i,4] <- subplot_anova_file_data[i,9]
}
else if ((subplot_anova_file_data[i,4] == "Whole_Plot"))
{
subplot_BLOCK[i,1] <- paste(subplot_anova_file_data[i,1],subplot_anova_file_data[i,2],subplot_anova_file_data[i,3],sep="-")
subplot_BLOCK[i,2] <- subplot_anova_file_data[i,5]
subplot_BLOCK[i,3] <- subplot_anova_file_data[i,8]
subplot_BLOCK[i,4] <- subplot_anova_file_data[i,9]
}
else if ((subplot_anova_file_data[i,4] == "Genotype"))
{
subplot_BLOCK[i,1] <- paste(subplot_anova_file_data[i,1],subplot_anova_file_data[i,2],subplot_anova_file_data[i,3],sep="-")
subplot_BLOCK[i,2] <- subplot_anova_file_data[i,5]
subplot_BLOCK[i,3] <- subplot_anova_file_data[i,8]
subplot_BLOCK[i,4] <- subplot_anova_file_data[i,9]
}
else
{
print  (paste("ERROR",subplot_anova_file_data[i,1],subplot_anova_file_data[i,2],subplot_anova_file_data[i,3],subplot_anova_file_data[i,4],sep="-"))
}
}
#####################################################################################################################################################
plot_anova_file_data<-unadjusted_plot_anova_stats
#debug
write.csv(p_row_col_values2, file = paste(DataFileDir,"DEBUG_p_row_col_values2",".csv",sep=""),row.names=FALSE)
write.csv(p_row_col_values , file = paste(DataFileDir,"DEBUG_p_row_col_values",".csv",sep=""),row.names=FALSE)
#debug
row_ids <- datap1$IDROW#row_ids
col_ids <- datap1$IDCOL#col_ids
control_genotypes <- unique(datap1cg$Genotype)
} else {
file.remove(DataFilenameConverted)
message("headers should be:Record	Plot	Row	Column	Cp	Csp	Entry	Year	Location	Genotype")
}
ControlSubPlotData
ControlSubPlotData
View(ControlPlotData)
msdataControlPlotData <- ControlPlotData %>% group_by(IDX) %>% summarize(across(c(Value, adjmth1, adjmth3, adjmth13), mean))
msdataControlPlotData
msdataControlPlotDataMean <- ControlPlotData %>% group_by(IDX) %>% summarize(across(c(Value, adjmth1, adjmth3, adjmth13), mean))
msdataControlPlotDataCV <- ControlPlotData %>% group_by(IDX) %>% summarize(across(c(Value, adjmth1, adjmth3, adjmth13), CV))
########################################################################################################CV
CV <- function(x) (sd(data) / mean(data) * 100)
msdataControlPlotDataMean <- ControlPlotData %>% group_by(IDX) %>% summarize(across(c(Value, adjmth1, adjmth3, adjmth13), mean))
msdataControlPlotDataCV <- ControlPlotData %>% group_by(IDX) %>% summarize(across(c(Value, adjmth1, adjmth3, adjmth13), CV))
########################################################################################################CV
CV <- function(x) (sd(x) / mean(x) * 100)
msdataControlPlotDataMean <- ControlPlotData %>% group_by(IDX) %>% summarize(across(c(Value, adjmth1, adjmth3, adjmth13), mean))
msdataControlPlotDataCV <- ControlPlotData %>% group_by(IDX) %>% summarize(across(c(Value, adjmth1, adjmth3, adjmth13), CV))
msdataControlPlotDataCV
CV <- function(x) (sd(x) / mean(x) * 100)
msdataControlPlotDataMean <- ControlPlotData %>% group_by(IDX) %>% summarize(across(c(Value, adjmth1, adjmth3, adjmth13), mean))
msdataControlPlotDataCV <- ControlPlotData %>% group_by(IDX) %>% summarize(across(c(Value, adjmth1, adjmth3, adjmth13), CV))
msdataControlSubPlotDataMean <- ControlSubPlotData %>% group_by(IDX) %>% summarize(across(c(Value, adjmth1, adjmth3, adjmth13), mean))
msdataControlSubPlotDataCV <- ControlSubPlotData %>% group_by(IDX) %>% summarize(across(c(Value, adjmth1, adjmth3, adjmth13), CV))
msdataControlSubPlotDataCV
write.csv(msdataControlPlotDataMean , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""),row.names=FALSE)
CV <- function(x) (sd(x) / mean(x) * 100)
msdataControlPlotDataMean <- ControlPlotData %>% group_by(IDX) %>% summarize(across(c(Value, adjmth1, adjmth3, adjmth13), mean))
msdataControlPlotDataCV <- ControlPlotData %>% group_by(IDX) %>% summarize(across(c(Value, adjmth1, adjmth3, adjmth13), CV))
msdataControlSubPlotDataMean <- ControlSubPlotData %>% group_by(IDX) %>% summarize(across(c(Value, adjmth1, adjmth3, adjmth13), mean))
msdataControlSubPlotDataCV <- ControlSubPlotData %>% group_by(IDX) %>% summarize(across(c(Value, adjmth1, adjmth3, adjmth13), CV))
write.csv(msdataControlPlotDataCV , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""),row.names=FALSE)
write.csv(msdataControlPlotDataMean , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""),row.names=FALSE)
write.csv(msdataControlSubPlotDataCV , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""),row.names=FALSE)
write.csv(msdataControlSubPlotDataMean , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""),row.names=FALSE)
########################################################################################################CV
ControlSubPlotData <- filter(data_file,(data_file$Csp > 0))
CV <- function(x) (sd(x) / mean(x) * 100)
msdataControlPlotDataMean <- ControlPlotData %>% group_by(IDX) %>% summarize(across(c(Value, adjmth1, adjmth3, adjmth13), mean))
msdataControlPlotDataCV <- ControlPlotData %>% group_by(IDX) %>% summarize(across(c(Value, adjmth1, adjmth3, adjmth13), CV))
msdataControlSubPlotDataMean <- ControlSubPlotData %>% group_by(IDX) %>% summarize(across(c(Value, adjmth1, adjmth3, adjmth13), mean))
msdataControlSubPlotDataCV <- ControlSubPlotData %>% group_by(IDX) %>% summarize(across(c(Value, adjmth1, adjmth3, adjmth13), CV))
write.csv(msdataControlPlotDataCV , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""),row.names=FALSE)
write.csv(msdataControlPlotDataMean , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""),row.names=FALSE, append = TRUE)
write.csv(msdataControlSubPlotDataCV , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""),row.names=FALSE, append = TRUE)
write.csv(msdataControlSubPlotDataMean , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""),row.names=FALSE, append = TRUE)
########################################################################################################CV
write.csv(msdataControlPlotDataCV , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""),row.names=FALSE)
write.csv(msdataControlPlotDataMean , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""),row.names=FALSE, append = TRUE)
write.table(msdataControlPlotDataMean , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""),row.names=FALSE, append = TRUE)
CV <- function(x) (sd(x) / mean(x) * 100)
msdataControlPlotDataMean <- ControlPlotData %>% group_by(IDX) %>% summarize(across(c(Value, adjmth1, adjmth3, adjmth13), mean))
msdataControlPlotDataCV <- ControlPlotData %>% group_by(IDX) %>% summarize(across(c(Value, adjmth1, adjmth3, adjmth13), CV))
msdataControlSubPlotDataMean <- ControlSubPlotData %>% group_by(IDX) %>% summarize(across(c(Value, adjmth1, adjmth3, adjmth13), mean))
msdataControlSubPlotDataCV <- ControlSubPlotData %>% group_by(IDX) %>% summarize(across(c(Value, adjmth1, adjmth3, adjmth13), CV))
write.csv(msdataControlPlotDataCV , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""),row.names=FALSE)
write.table(msdataControlPlotDataMean , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""),row.names=FALSE, append = TRUE)
write.table(msdataControlSubPlotDataCV , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""),row.names=FALSE, append = TRUE)
write.table(msdataControlSubPlotDataMean , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""),row.names=FALSE, append = TRUE)
########################################################################################################CV
ControlSubPlotData <- filter(data_file,(data_file$Csp > 0))
CV <- function(x) (sd(x) / mean(x) * 100)
msdataControlPlotDataMean <- ControlPlotData %>% group_by(IDX) %>% summarize(across(c(Value, adjmth1, adjmth3, adjmth13), mean))
msdataControlPlotDataCV <- ControlPlotData %>% group_by(IDX) %>% summarize(across(c(Value, adjmth1, adjmth3, adjmth13), CV))
msdataControlSubPlotDataMean <- ControlSubPlotData %>% group_by(IDX) %>% summarize(across(c(Value, adjmth1, adjmth3, adjmth13), mean))
msdataControlSubPlotDataCV <- ControlSubPlotData %>% group_by(IDX) %>% summarize(across(c(Value, adjmth1, adjmth3, adjmth13), CV))
write.csv(msdataControlPlotDataCV , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""),row.names=FALSE)
write.table(msdataControlPlotDataMean , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=","),row.names=FALSE, append = TRUE)
write.table(msdataControlSubPlotDataCV , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=","),row.names=FALSE, append = TRUE)
write.table(msdataControlSubPlotDataMean , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=","),row.names=FALSE, append = TRUE)
########################################################################################################CV
CV <- function(x) (sd(x) / mean(x) * 100)
msdataControlPlotDataMean <- ControlPlotData %>% group_by(IDX) %>% summarize(across(c(Value, adjmth1, adjmth3, adjmth13), mean))
msdataControlPlotDataCV <- ControlPlotData %>% group_by(IDX) %>% summarize(across(c(Value, adjmth1, adjmth3, adjmth13), CV))
msdataControlSubPlotDataMean <- ControlSubPlotData %>% group_by(IDX) %>% summarize(across(c(Value, adjmth1, adjmth3, adjmth13), mean))
msdataControlSubPlotDataCV <- ControlSubPlotData %>% group_by(IDX) %>% summarize(across(c(Value, adjmth1, adjmth3, adjmth13), CV))
write.csv(msdataControlPlotDataCV , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""),row.names=FALSE)
write.csv(msdataControlPlotDataMean , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""), sep = ",",row.names=FALSE, append = TRUE)
write.csv(msdataControlSubPlotDataCV , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""), sep = ",",row.names=FALSE, append = TRUE)
write.csv(msdataControlSubPlotDataMean , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""), sep = ",",row.names=FALSE, append = TRUE)
########################################################################################################CV
CV <- function(x) (sd(x) / mean(x) * 100)
msdataControlPlotDataMean <- ControlPlotData %>% group_by(IDX) %>% summarize(across(c(Value, adjmth1, adjmth3, adjmth13), mean))
msdataControlPlotDataCV <- ControlPlotData %>% group_by(IDX) %>% summarize(across(c(Value, adjmth1, adjmth3, adjmth13), CV))
msdataControlSubPlotDataMean <- ControlSubPlotData %>% group_by(IDX) %>% summarize(across(c(Value, adjmth1, adjmth3, adjmth13), mean))
msdataControlSubPlotDataCV <- ControlSubPlotData %>% group_by(IDX) %>% summarize(across(c(Value, adjmth1, adjmth3, adjmth13), CV))
write.csv(msdataControlPlotDataCV , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""),row.names=FALSE)
write.csv(msdataControlPlotDataMean , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""), sep = ",",row.names=FALSE, append = TRUE)
write.csv(msdataControlSubPlotDataCV , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""), sep = ",",row.names=FALSE, append = TRUE)
write.csv(msdataControlSubPlotDataMean , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""), sep = ",",row.names=FALSE, append = TRUE)
########################################################################################################CV
CV <- function(x) (sd(x) / mean(x) * 100)
msdataControlPlotDataMean <- ControlPlotData %>% group_by(IDX) %>% summarize(across(c(Value, adjmth1, adjmth3, adjmth13), mean))
msdataControlPlotDataCV <- ControlPlotData %>% group_by(IDX) %>% summarize(across(c(Value, adjmth1, adjmth3, adjmth13), CV))
msdataControlSubPlotDataMean <- ControlSubPlotData %>% group_by(IDX) %>% summarize(across(c(Value, adjmth1, adjmth3, adjmth13), mean))
msdataControlSubPlotDataCV <- ControlSubPlotData %>% group_by(IDX) %>% summarize(across(c(Value, adjmth1, adjmth3, adjmth13), CV))
write.csv(msdataControlPlotDataCV , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""),row.names=FALSE)
write.table(msdataControlPlotDataMean , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""), sep = ",",row.names=FALSE, append = TRUE)
write.table(msdataControlSubPlotDataCV , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""), sep = ",",row.names=FALSE, append = TRUE)
write.table(msdataControlSubPlotDataMean , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""), sep = ",",row.names=FALSE, append = TRUE)
########################################################################################################CV
dfs <- c(msdataControlPlotDataCV, msdataControlPlotDataMean, msdataControlSubPlotDataCV , msdataControlSubPlotDataMean)
for (df in dfs){
write.csv(df, paste(DataFileDircsv,"Newcalculate_all_CV.csv"), append = TRUE)
}
fileConn<-file(paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""))
writeLines(c("Hello","World"), fileConn)
close(fileConn)
write.table(msdataControlPlotDataCV , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""), sep = ",",row.names=FALSE, append = TRUE)
write.table(msdataControlPlotDataMean , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""), sep = ",",row.names=FALSE)
write.table(msdataControlSubPlotDataCV , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""), sep = ",",row.names=FALSE, append = TRUE)
write.table(msdataControlSubPlotDataMean , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""), sep = ",",row.names=FALSE, append = TRUE)
fileConn<-file(paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""))
writeLines(c("ControlPlotDataCV",":"), fileConn)
close(fileConn)
write.table(msdataControlPlotDataCV , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""), sep = ",",row.names=FALSE, append = TRUE)
write.table(msdataControlPlotDataMean , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""), sep = ",",row.names=FALSE, append = TRUE)
write.table(msdataControlSubPlotDataCV , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""), sep = ",",row.names=FALSE, append = TRUE)
write.table(msdataControlSubPlotDataMean , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""), sep = ",",row.names=FALSE, append = TRUE)
fileConn<-file(paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""))
writeLines(c("Control Plot Data Coeff of Variation"), fileConn)
close(fileConn)
write.table(msdataControlPlotDataCV , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""), sep = ",",row.names=FALSE, append = TRUE)
fileConn<-file(paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""))
writeLines(c("Control Plot Data MEAN"), fileConn)
close(fileConn)
write.table(msdataControlPlotDataMean , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""), sep = ",",row.names=FALSE, append = TRUE)
fileConn<-file(paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""))
writeLines(c("Control Sub Plot Data Coeff of Variation"), fileConn)
close(fileConn)
write.table(msdataControlSubPlotDataCV , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""), sep = ",",row.names=FALSE, append = TRUE)
fileConn<-file(paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""))
writeLines(c("Control Sub Plot Mean"), fileConn)
close(fileConn)
write.table(msdataControlSubPlotDataMean , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""), sep = ",",row.names=FALSE, append = TRUE)
fileConn<-file(paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""))
writeLines(c("Control Plot Data Coeff of Variation"), fileConn)
close(fileConn)
write.table(msdataControlPlotDataCV , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""), sep = ",",row.names=FALSE, append = TRUE)
fileConn<-file(paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""))
writeLines(c("Control Plot Data MEAN"), fileConn)
close(fileConn)
fileConn<-file(paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""))
writeLines(c("Control Plot Data Coeff of Variation"), fileConn)
close(fileConn)
write.table(msdataControlPlotDataCV , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""), sep = ",",row.names=FALSE, append = TRUE)
fileConn<-file(paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""))
writeLines(c("Control Plot Data MEAN"), fileConn , append = TRUE)
close(fileConn)
fileConn<-file(paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""))
writeLines(c("Control Plot Data Coeff of Variation"), fileConn)
close(fileConn)
write.table(msdataControlPlotDataCV , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""), sep = ",",row.names=FALSE, append = TRUE)
write("Control Plot Data MEAN",file="myfile.txt",append=TRUE)
fileConn<-file(paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""))
writeLines(c("Control Plot Data Coeff of Variation"), fileConn)
close(fileConn)
write.table(msdataControlPlotDataCV , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""), sep = ",",row.names=FALSE, append = TRUE)
write("Control Plot Data MEAN",file=paste(DataFileDircsv,"calculate_all_CV ",".csv"),append=TRUE)
fileConn<-file(paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""))
writeLines(c("Control Plot Data Coeff of Variation"), fileConn)
close(fileConn)
write.table(msdataControlPlotDataCV , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""), sep = ",",row.names=FALSE, append = TRUE)
write("Control Plot Data MEAN",file=paste(DataFileDircsv,"calculate_all_CV ",".csv"),append=TRUE)
fileConn<-file(paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""))
writeLines(c("Control Plot Data Coeff of Variation"), fileConn)
close(fileConn)
write.table(msdataControlPlotDataCV , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""), sep = ",",row.names=FALSE, append = TRUE)
write("Control Plot Data MEAN",file=paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""),append=TRUE)
fileConn<-file(paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""))
writeLines(c("Control Plot Data Coeff of Variation"), fileConn)
close(fileConn)
write.table(msdataControlPlotDataCV , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""), sep = ",",row.names=FALSE, append = TRUE)
write("Control Plot Data MEAN",file=paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""),append=TRUE)
write.table(msdataControlPlotDataMean , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""), sep = ",",row.names=FALSE, append = TRUE)
write("Control Sub Plot Data Coeff of Variation",file=paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""),append=TRUE)
write.table(msdataControlSubPlotDataCV , file =paste(DataFileDircsv,"calculate_all_CV ",".csv",sep="") , sep = ",",row.names=FALSE, append = TRUE)
write("Control Sub Plot Mean",file=paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""),append=TRUE)
write.table(msdataControlSubPlotDataMean , file = paste(DataFileDircsv,"calculate_all_CV ",".csv",sep=""), sep = ",",row.names=FALSE, append = TRUE)
